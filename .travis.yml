sudo: required
services:
- docker
script:
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
- docker build -t consul-server docker-images/consul-server
- docker tag consul-server ${DOCKER_USERNAME}/consul-server:$COMMIT
- docker push ${DOCKER_USERNAME}/consul-server:$COMMIT
- docker build -t consul-agent docker-images/consul-agent
- docker tag consul-agent ${DOCKER_USERNAME}/consul-agent:$COMMIT
- docker push ${DOCKER_USERNAME}/consul-agent:$COMMIT
- docker build -t consul-registrator docker-images/consul-registrator
- docker tag consul-server ${DOCKER_USERNAME}/consul-registrator:$COMMIT
- docker push ${DOCKER_USERNAME}/consul-registrator:$COMMIT
- docker build -t linkerd docker-images/linkerd
- docker tag consul-server ${DOCKER_USERNAME}/linkerd:$COMMIT
- docker push ${DOCKER_USERNAME}/linkerd:$COMMIT
env:
  matrix:
  - COMMIT=${TRAVIS_COMMIT::8}
  - DOCKER_USERNAME=piotrjaromin
  - secure: BvLBW6VlLhXwp6AV0b4h8HumYFLU4tcKKCvXPZXBamyjSmeMCKpJF/RiTzNKi9Bs5VgXlhblLERYSKELr9azEhtwSQKURF2J+kEGZAztbahuJ63wNGTPCnyKEHTrpUdbErGcl/PMinCjCSm25GwCGAYu+0qAAmHGgDu+m8h3MSEQOc06PCmrmYyd7Oa1rQLRMSJ3mpysmIBpuB/dfVqbmxkx+oGIZsCTK9o8T8lHA4u5d6OAhF+bIZRuqQ2xVmd/aVH1cQ3kFECJDUXsqZfuQglGeB3iJd1e2x9EluL/uuMN7Ew4PZzqrvTC6BKpGEoeWkBQMbSA8NjZCJ0OaQy4VU9ajFHS8tXqvn+D5uqmyEs0GCsXK5kNalFFpAWFpEXgdPOfFUag46qHTJmuOd/AsMXwqV8uS0ttdTqavbxu9HmrNJ1kE67ke2173X8r8C6y5CbqZqisG9loZ6oABFmN14NJBqFz9EWVSmcloHKhqhq7+ePAO+tjhWQKnLEm2A2xnv5Vbz10pKXObidcC6DagcYpTHseAKxtNaV907bXSqgCfF+6nZyfRo/TmFiVDvDNLeHnc8niGStHULhnK2GnkYJoWPivGWqkbVWHgHBh+4VZTLUXo1NrKeY/Vl7LRspi1hGgMr6bQbXA1HO/hM7yQLZSC1QDSAFUfegWlXwLH5M=
